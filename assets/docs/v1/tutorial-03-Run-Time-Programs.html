<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Run Time Programs</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
             
                <a href="index.html">
                    <h1 class="navbar-item">RPGWizard Documentation</h1>
                </a>
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    API Documentation
                </a>
                
                <div class="dropdown is-hoverable is-right">
                    <a class="dropdown-trigger link">
                        Tutorials
                        <i class="fas fa-chevron-down fa-xs"></i>
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-content">
                        
                            <a class="dropdown-item" href="tutorial-01-Getting-Started.html">
                                Getting Started
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-02-Your-First-Game.html">
                                Your First Game
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-03-Programming-Guide.html">
                                Programming Guide
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-04-Default-Systems.html">
                                Default Systems
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-05-Example-Games.html">
                                Example Games
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-06-Advanced-Topics.html">
                                Advanced Topics
                            </a>
                        
                        </div>
                    </div>
                </div>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar tutorials"
            id="sidebarNav"
        >
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    <div class="category"><h3>Tutorials</h3><ul><li><a href="tutorial-01-Getting-Started.html">Getting Started</a><ul><li><a href="tutorial-01-Trying-Out-the-Demo.html">Trying Out the Demo</a></li><li><a href="tutorial-01-Accessing-the-Console.html">Accessing the Console</a></li></ul></li><li><a href="tutorial-02-Your-First-Game.html">Your First Game</a><ul><li><a href="tutorial-02-Starting-a-New-Project.html">Starting a New Project</a></li><li><a href="tutorial-02-Creating-an-Animation.html">Creating an Animation</a></li><li><a href="tutorial-02-Creating-a-Character.html">Creating a Character</a></li><li><a href="tutorial-02-Creating-a-Tileset.html">Creating a Tileset</a></li><li><a href="tutorial-02-Creating-a-Board.html">Creating a Board</a></li><li><a href="tutorial-02-Creating-a-Board-Layer.html">Creating a Board Layer</a></li><li><a href="tutorial-02-Adding-a-Solid-Board-Vector.html">Adding a Solid Board Vector</a></li><li><a href="tutorial-02-Moving-between-Boards.html">Moving between Boards</a></li><li><a href="tutorial-02-Creating-an-NPC.html">Creating an NPC</a></li><li><a href="tutorial-02-Creating-a-Board-Sprite.html">Creating a Board Sprite</a></li><li><a href="tutorial-02-Creating-an-Inventory-Item.html">Creating an Inventory Item</a></li></ul></li><li><a href="tutorial-03-Programming-Guide.html">Programming Guide</a><ul><li><a href="tutorial-03-Hello-World.html">Hello world!</a></li><li><a href="tutorial-03-Ending-a-Program.html">Ending a Program</a></li><li><a href="tutorial-03-Introduction-to-JavaScript.html">Introduction to JavaScript</a></li><li><a href="tutorial-03-Asset-Management.html">Asset Management</a></li><li><a href="tutorial-03-Global-Variables.html">Global Variables</a></li><li><a href="tutorial-03-Working-with-Graphics.html">Working with Graphics</a></li><li><a href="tutorial-03-Working-with-Canvases.html">Working with Canvases</a></li><li><a href="tutorial-03-User-Input.html">User Input</a></li><li><a href="tutorial-03-File-Handling.html">File Handling</a></li><li><a href="tutorial-03-Sprite-Threads.html">Sprite Threads</a></li><li><a href="tutorial-03-Run-Time-Programs.html">Run Time Programs</a></li></ul></li><li><a href="tutorial-04-Default-Systems.html">Default Systems</a><ul><li><a href="tutorial-04-Setting-up-the-Default-Systems.html">Setup Process</a></li><li><a href="tutorial-04-Title-Screen.html">Title Screen</a></li><li><a href="tutorial-04-Dialog-Window.html">Dialog Window</a></li><li><a href="tutorial-04-Battle-System.html">Battle System</a></li><li><a href="tutorial-04-Weather-Effects.html">Weather Effects</a></li></ul></li><li><a href="tutorial-05-Example-Games.html">Example Games</a><ul><li><a href="tutorial-05-The-Vent.html">The Vent</a></li></ul></li><li><a href="tutorial-06-Advanced-Topics.html">Advanced Topics</a><ul><li><a href="tutorial-06-Canvas-2D-Context.html">Canvas 2D Context</a></li><li><a href="tutorial-06-Writing-Modules.html">Writing Modules</a></li></ul></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Tutorial</p>
                    <h1>Run Time Programs</h1>
                </header>
                <section>

<article>
    <h2>Summary</h2>
<p>Sometimes you need a program to run for longer than just a single event or the
life span of a sprite to create things like HUDs and Weather Effects.</p>
<p>Enter the Run Time Program, always running, always updating, and it will not stop,
until it is stopped!</p>
<h2>When and when not to use them</h2>
<h3>Use them for</h3>
<ul>
<li>Long lived programs, that need to run across board environments.</li>
<li>Things like Graphical UIs are a good application of them.
<ul>
<li>HUDs are a common use case.</li>
</ul>
</li>
<li>Weather, Day &amp; Night cycles, Clocks, etc.
<ul>
<li>Anything that is constantly happening in your game!</li>
</ul>
</li>
</ul>
<h3>Don't use them for</h3>
<ul>
<li>Short lived things, that only happen in very specific circumstances.
<ul>
<li>Instead try to use Events or Sprite Threads if possible.</li>
</ul>
</li>
</ul>
<h2>Key things about Run Time Programs</h2>
<ul>
<li><strong>Don't use rpgcode.endProgram in programs meant for Run Time.</strong>
<ul>
<li>Run Time Programs are constantly being executed start to finish by the engine.</li>
<li>Instead use control variables to ensure executions don't overlap.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li><strong>Run Times will keep being called until they are destroyed.</strong>
<ul>
<li>Its good practice to destroy a Run Time program once you are done with it.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li><strong>Slow running Run Times will slow the engine down!</strong>
<ul>
<li>Stick to simple calculations to avoid game slowdowns.</li>
<li>Or put things on delayed callbacks so they don't execute often.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li><strong>If you want to prevent a Run Time from executing use return.</strong>
<ul>
<li>Use the JavaScript <strong>return;</strong> statement at the highest level of the Run Time.</li>
<li>When nested in functions, use a chain of return statements.</li>
</ul>
</li>
</ul>
<br/>
<hr>
<h2>Example Usage</h2>
<h3>Character Health</h3>
<p>One of the most common applications for a Run Time is something like a HUD, which
typically tells the player in realtime important stats about their current health,
ammo, magic power, etc.</p>
<p>We are going to create a basic yet functional HUD program that displays the
character's current health.</p>
<p><img src="images/programming_guide/08_run_time_programs/images/1.gif" alt=""></p>
<br/>
<h4>The Code</h4>
<p>For the most basic version of this program all we need to do is the following:</p>
<ol>
<li>Get the current character.</li>
<li>Clear the current screen.</li>
<li>Draw the health back to the screen.</li>
</ol>
<p>To achieve this all we need is a couple of lines of code:</p>
<pre class="prettyprint source lang-javascript"><code>// NOTE: You don't need to use endProgram for a Run Time, they are always running!

// 1: Get the current character
const character = rpgcode.getCharacter();

// 2: Draw the current character's health to the screen.
rpgcode.clearCanvas();
rpgcode.setColor(255, 255, 255, 1);
rpgcode.drawText(30, 30, &quot;Health: &quot; + character.health + &quot;/&quot; + character.maxHealth);
rpgcode.renderNow();
</code></pre>
<br/>
<p>If you run this program you should end up with something like this:</p>
<p><img src="images/programming_guide/08_run_time_programs/images/2.png" alt=""></p>
<br/>
<h4>Running at Startup</h4>
<p>The next thing we want to do is get this program running constantly in the
background displaying changes to the character's health as they occur.</p>
<p>To achieve this you'll need to add the following to your <strong>Startup</strong> program,
make sure to pass the name you gave your program!</p>
<pre class="prettyprint source lang-javascript"><code>// Add this into your Startup program
rpgcode.addRunTimeProgram(&quot;health.js&quot;);
</code></pre>
<br/>
<p>This tells the engine that you want this particular program to run in the
background constantly until you tell it to stop.</p>
<p>If you play your game now you should see the health counter at the top. Open a
console using F12 you can run the following to test it out:</p>
<pre class="prettyprint source lang-javascript"><code>rpgcode.getCharacter().health -= 1;
</code></pre>
<br/>
<h4>Removing a Run Time Program</h4>
<p>To remove a Run Time from the engine simply call:</p>
<pre class="prettyprint source lang-javascript"><code>rpgcode.removeRunTimeProgram(&quot;health.js&quot;);
</code></pre>
<br/>
<h4>Optimising our Run Time Program</h4>
<p>We can optimise our HUD drawing code by only updating the screen when the health
has actually changed since the last check.</p>
<p>To do this we'll introduce a Global named &quot;lastHealth&quot;, this will be used to store
the last health value of the character. We can check against our previous value
stored in the Global and decide whether or not the screen needs updating.</p>
<p>If the health doesn't need updating we can simply use the <strong>return</strong> statement
to make sure the Run Time Program stops executing.</p>
<pre class="prettyprint source lang-javascript"><code>// NOTE: You don't need to use endProgram for a Run Time, they are always running!

// 1: Get the current character
const character = rpgcode.getCharacter();

// 2: Check to see if our Global exists yet
if (rpgcode.getGlobal(&quot;lastHealth&quot;)) {

   // 2a: It does now check to see if it has changed since last time
   if (rpgcode.getGlobal(&quot;lastHealth&quot;) === character.health) {

      // There is no change, leave the Run Time Program
      return;

   } else {

      // There is a change update it
      rpgcode.setGlobal(&quot;lastHealth&quot;, character.health);

   }

} else {

   // 2c: Global doesn't exist, record the current character health
   //     will check against it next time
   rpgcode.setGlobal(&quot;lastHealth&quot;, character.health);

}

// 3: Draw the current character's health to the screen.
//    Will only reach here if the health has actually changed
rpgcode.clearCanvas();
rpgcode.setColor(255, 255, 255, 1);
rpgcode.drawText(30, 30, &quot;Health: &quot; + character.health + &quot;/&quot; + character.maxHealth);
rpgcode.renderNow();
</code></pre>
<br/>
<h2>More Advanced Examples</h2>
<p>You can find a number of examples of how to use Run Time programs for Weather,
Day &amp; Night, to HUDs scattered across the demo games, here is a short list of
the most interesting ones:</p>
<ul>
<li><a href="https://github.com/swordmaster2k/rpgwizard/blob/develop/demo/The%20Wizard's%20Tower/Programs/defaults/weather.js" target="_blank">Default Weather Effects</a></li>
</ul>
</article>

</section>

            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>

</body>
</html>